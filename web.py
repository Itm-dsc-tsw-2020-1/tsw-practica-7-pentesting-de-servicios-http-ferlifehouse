from bs4 import BeautifulSoup
from conexion import obtener_contenido

#Tenemos que descargar BeautifulSoup con "pip install beutifulsoup4"

#Trabajamos con el archivo conexion.py y hacemos uso de la funci√≥n "obtener_contenido"

def obtener_links():

    datos = obtener_contenido(False)
    aux = {}

    for host, text in datos.items():
        soup = BeautifulSoup(text, 'html.parser')
        aux[host] = []
        a = soup.find_all('form')

        if a:
            for form in a:
                res = form.get('res')
                if res:
                    aux2 = {}
                    aux2['res'] = res
                    inputs = form.find_all('input', attrs={'name':True})
                    val = {inpu['name']:inpu.get('value', '') for inpu in inputs}
                    aux2['val'] = val
                    aux[host].append(aux2)

        if not aux[host]:
            for anchor in soup.find_all('a'):
                link = anchor.get('href')
                if link:
                    aux[host].append(link)

    return aux

if __name__ == '__main__':
    aux = obtener_links()
    print(aux)
